<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ExplicitNamespaces #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Rhythm.Random</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalStateT</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">modifyM</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.html"><span class="hs-identifier">Data.Finite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#Finite"><span class="hs-identifier">Finite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#finite"><span class="hs-identifier">finite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#getFinite"><span class="hs-identifier">getFinite</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html"><span class="hs-identifier">Data.Vector.Sized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html#Vector"><span class="hs-identifier">Vector</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html"><span class="hs-identifier">Data.Vector.Sized</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VS</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(+)</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/nw5w9j4r5vvcc1s96zslh297n71vw4dh-random-1.2.1.2-doc/share/doc/random-1.2.1.2/html/src/System.Random.html"><span class="hs-identifier">System.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/nw5w9j4r5vvcc1s96zslh297n71vw4dh-random-1.2.1.2-doc/share/doc/random-1.2.1.2/html/src/System.Random.html#randomIO"><span class="hs-identifier">randomIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="annot"><span class="hs-comment">-- | Generate a vector of random numbers with specified correlation.</span></span><span>
</span><span id="line-18"></span><span class="annot"><a href="Data.Rhythm.Random.html#randomFinites"><span class="hs-identifier hs-type">randomFinites</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679116493"><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span id="local-6989586621679116494"><span class="annot"><a href="#local-6989586621679116494"><span class="hs-identifier hs-type">y</span></a></span></span><span> </span><span id="local-6989586621679116495"><span class="annot"><a href="#local-6989586621679116495"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679116494"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679116495"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#Finite"><span class="hs-identifier hs-type">Finite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#Finite"><span class="hs-identifier hs-type">Finite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="#local-6989586621679116495"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html#Vector"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679116494"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#Finite"><span class="hs-identifier hs-type">Finite</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span id="randomFinites"><span class="annot"><span class="annottext">randomFinites :: forall (x :: Nat) (y :: Nat) (m :: * -&gt; *).
(KnownNat x, KnownNat y, MonadIO m) =&gt;
Finite x -&gt; Finite x -&gt; m (Vector (1 + y) (Finite x))
</span><a href="Data.Rhythm.Random.html#randomFinites"><span class="hs-identifier hs-var hs-var">randomFinites</span></a></span></span><span> </span><span id="local-6989586621679116595"><span class="annot"><span class="annottext">Finite x
</span><a href="#local-6989586621679116595"><span class="hs-identifier hs-var">startingNumber</span></a></span></span><span> </span><span id="local-6989586621679116596"><span class="annot"><span class="annottext">Finite x
</span><a href="#local-6989586621679116596"><span class="hs-identifier hs-var">correlation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="annottext">Finite x -&gt; Vector y (Finite x) -&gt; Vector (1 + y) (Finite x)
forall (n :: Nat) a. a -&gt; Vector n a -&gt; Vector (1 + n) a
</span><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html#cons"><span class="hs-identifier hs-var">VS.cons</span></a></span><span> </span><span class="annot"><span class="annottext">Finite x
</span><a href="#local-6989586621679116595"><span class="hs-identifier hs-var">startingNumber</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="annottext">(Vector y (Finite x) -&gt; Vector (1 + y) (Finite x))
-&gt; m (Vector y (Finite x)) -&gt; m (Vector (1 + y) (Finite x))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT Integer m (Vector y (Finite x))
-&gt; Integer -&gt; m (Vector y (Finite x))
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateT Integer m (Finite x)
-&gt; StateT Integer m (Vector y (Finite x))
forall (n :: Nat) (m :: * -&gt; *) a.
(KnownNat n, Monad m) =&gt;
m a -&gt; m (Vector n a)
</span><a href="file:///nix/store/0ghjrws1f99l073yhpwc34cy9ddfan59-vector-sized-1.5.0-doc/share/doc/vector-sized-1.5.0/html/src/Data.Vector.Sized.html#replicateM"><span class="hs-identifier hs-var">VS.replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">StateT Integer m (Finite x)
</span><a href="#local-6989586621679116600"><span class="hs-identifier hs-var">generateNumbers</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Finite x -&gt; Integer
forall (n :: Nat). Finite n -&gt; Integer
</span><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#getFinite"><span class="hs-identifier hs-var">getFinite</span></a></span><span> </span><span class="annot"><span class="annottext">Finite x
</span><a href="#local-6989586621679116595"><span class="hs-identifier hs-var">startingNumber</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>    </span><span id="local-6989586621679116600"><span class="annot"><span class="annottext">generateNumbers :: StateT Integer m (Finite x)
</span><a href="#local-6989586621679116600"><span class="hs-identifier hs-var hs-var">generateNumbers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Finite x) -&gt; StateT Integer m (Finite x)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Finite x
forall (n :: Nat). KnownNat n =&gt; Integer -&gt; Finite n
</span><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#finite"><span class="hs-identifier hs-var">finite</span></a></span><span> </span><span class="annot"><span class="annottext">StateT Integer m (Finite x)
-&gt; StateT Integer m () -&gt; StateT Integer m (Finite x)
forall a b.
StateT Integer m a -&gt; StateT Integer m b -&gt; StateT Integer m a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; m Integer) -&gt; StateT Integer m ()
forall (m :: * -&gt; *) s. Monad m =&gt; (s -&gt; m s) -&gt; StateT s m ()
</span><span class="hs-identifier hs-var">modifyM</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; m Integer
</span><a href="#local-6989586621679116612"><span class="hs-identifier hs-var">applyCorrelation</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span id="local-6989586621679116612"><span class="annot"><span class="annottext">applyCorrelation :: Integer -&gt; m Integer
</span><a href="#local-6989586621679116612"><span class="hs-identifier hs-var hs-var">applyCorrelation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-31"></span><span>      </span><span class="annot"><span class="annottext">(Integer -&gt; [Integer] -&gt; m Integer)
-&gt; [Integer] -&gt; Integer -&gt; m Integer
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; m Integer)
-&gt; Integer -&gt; [Integer] -&gt; m Integer
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; m Integer
forall {f :: * -&gt; *} {a} {a}.
(Integral a, Integral a, MonadIO f) =&gt;
a -&gt; a -&gt; f a
</span><a href="#local-6989586621679116640"><span class="hs-identifier hs-var">doDecrement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116641"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116641"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116641"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116642"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><span class="annottext">(Integer -&gt; m Integer)
-&gt; (Integer -&gt; m Integer) -&gt; Integer -&gt; m Integer
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; [Integer] -&gt; m Integer)
-&gt; [Integer] -&gt; Integer -&gt; m Integer
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; m Integer)
-&gt; Integer -&gt; [Integer] -&gt; m Integer
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; m Integer
forall {f :: * -&gt; *} {p}. MonadIO f =&gt; Integer -&gt; p -&gt; f Integer
</span><a href="#local-6989586621679116644"><span class="hs-identifier hs-var">doIncrement</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116642"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span id="local-6989586621679116640"><span class="annot"><span class="annottext">doDecrement :: a -&gt; a -&gt; f a
</span><a href="#local-6989586621679116640"><span class="hs-identifier hs-var hs-var">doDecrement</span></a></span></span><span> </span><span id="local-6989586621679116699"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116699"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span id="local-6989586621679116700"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116700"><span class="hs-identifier hs-var">divisor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool -&gt; a
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116699"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116699"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; a) -&gt; (Double -&gt; Bool) -&gt; Double -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116699"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679116700"><span class="hs-identifier hs-var">divisor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><span class="annottext">(Double -&gt; a) -&gt; f Double -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Double -&gt; f Double
forall a. IO a -&gt; f a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (Random a, MonadIO m) =&gt; m a
</span><a href="file:///nix/store/nw5w9j4r5vvcc1s96zslh297n71vw4dh-random-1.2.1.2-doc/share/doc/random-1.2.1.2/html/src/System.Random.html#randomIO"><span class="hs-identifier hs-var">randomIO</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span id="local-6989586621679116644"><span class="annot"><span class="annottext">doIncrement :: Integer -&gt; p -&gt; f Integer
</span><a href="#local-6989586621679116644"><span class="hs-identifier hs-var hs-var">doIncrement</span></a></span></span><span> </span><span id="local-6989586621679116721"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116721"><span class="hs-identifier hs-var">prev</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-40"></span><span>      </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool -&gt; Integer
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116721"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116641"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679116721"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Integer) -&gt; f Bool -&gt; f Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; f Bool
forall a. IO a -&gt; f a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO Bool
forall a (m :: * -&gt; *). (Random a, MonadIO m) =&gt; m a
</span><a href="file:///nix/store/nw5w9j4r5vvcc1s96zslh297n71vw4dh-random-1.2.1.2-doc/share/doc/random-1.2.1.2/html/src/System.Random.html#randomIO"><span class="hs-identifier hs-var">randomIO</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679116642"><span class="annot"><span class="annottext">c :: Integer
</span><a href="#local-6989586621679116642"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Finite x -&gt; Integer
forall (n :: Nat). Finite n -&gt; Integer
</span><a href="file:///nix/store/dvzrkh355prh5xf41lhhrjwwdp9h4g5a-finite-typelits-0.1.6.0-doc/share/doc/finite-typelits-0.1.6.0/html/src/Data.Finite.Internal.html#getFinite"><span class="hs-identifier hs-var">getFinite</span></a></span><span> </span><span class="annot"><span class="annottext">Finite x
</span><a href="#local-6989586621679116596"><span class="hs-identifier hs-var">correlation</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679116641"><span class="annot"><span class="annottext">m :: Integer
</span><a href="#local-6989586621679116641"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy x -&gt; Integer
forall (n :: Nat) (proxy :: Nat -&gt; *).
KnownNat n =&gt;
proxy n -&gt; Integer
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: Nat). Proxy t
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679116493"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-45"></span></pre></body></html>